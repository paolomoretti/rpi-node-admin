// Generated by CoffeeScript 1.6.3
var Admin, Home, Main, Webcam;

Admin = angular.module("Admin", ["ngRoute"]);

Admin.config([
  "$routeProvider", function($routeProvider) {
    $routeProvider.when("/", {
      templateUrl: "/assets/templates/home.html",
      controller: "Home"
    });
    return $routeProvider.when("/webcam/", {
      templateUrl: "/assets/templates/webcam.html",
      controller: "Webcam"
    });
  }
]);

Main = function($scope) {};

Home = function($scope) {
  return console.log("Scope", $scope);
};

Webcam = function($scope, $http, $timeout) {
  $scope.webcamSrc = "http://bitter.kicks-ass.org:9999/webcam/webcam.jpeg?timestamp=1432423";
  $scope.actionLabel = "Start webcam";
  $scope.started = false;
  $scope.executing = false;
  $scope.freq = 1;
  $scope.toggleWebcam = function() {
    $scope.executing = true;
    if ($scope.started === false) {
      return $http.get("/webcam/start").success(function(res) {
        return $scope.started = res === "ok";
      });
    } else {
      return $http.get("/webcam/stop").success(function(res) {
        return $scope.started = false;
      });
    }
  };
  return $scope.$watch("started", function(newVal) {
    $scope.actionLabel = newVal === true ? "Stop webcam" : "Start webcam";
    $scope.executing = false;
    if (newVal === true) {
      return $scope.intId = setInterval(function() {
        return $timeout((function() {
          return $scope.webcamSrc = $scope.webcamSrc.split("timestamp=")[0] + Date.now();
        }), 0);
      }, $scope.freq * 1000);
    } else {
      return clearInterval($scope.intId);
    }
  });
};
